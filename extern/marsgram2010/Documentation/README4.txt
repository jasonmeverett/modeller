              Auxiliary Programs for Use with Mars-GRAM

This file discusses four auxiliary programs, provided for use with
Mars-GRAM: BLDTRAJ.f90, finddate.f90, marsrad.f90, and radtraj.f90.  The stand-
alone version Mars-GRAM program files (marsgram_M10.f90, marssubs_M10.f90, and
setup_M10.f90) are discussed in file README1.txt.  Files README1.txt and
README2.txt discuss dummy trajectory programs dumytraj_M10.f90 and 
multtraj_M10.f90, which provide examples of how to use Mars-GRAM as a 
subroutine in trajectory programs or orbit propagator programs.  Programs 
makebin.f90, readalb.f90, and READTOPO.f90, which convert data provided in ASCII 
format into binary files, are discussed in the files README1.txt and README3.txt.


                            PROGRAM BLDTRAJ

BLDTRAJ.f90    - program to build pseudo-trajectory file for use in Mars-
                 GRAM to compute output for maps or cross-sections

It is frequently desirable to produce Mars-GRAM output for graphing as a
map (i.e. lat-lon cross section at a given height) or other cross-section
(e.g. height-lat cross section at a given longitude).  Program BLDTRAJ.f90
generates a "trajectory" file (with input lines containing time, height,
latitude, and longitude) that can be used as Mars-GRAM input for
generation of such maps or cross-sections.  Program BLDTRAJ is interactive
and prompts the user to input starting values, ending values, and step
sizes for height (z1,z2,dz), latitude (lat1,lat2,dlat), and longitude
(lon1,lon2,dlon).  The program also prompts for a value of time increment
which is applied between each "trajectory" step (the time increment may
be 0, if all trajectory points are at the same time). Time values in the
trajectory file are time (seconds) from the start time specified by date
and time information provided in the Mars-GRAM NAMELIST-format input file.

NOTE: If heights > 3000 km are used, they are interpreted as planeto-centric
      radius values (km)

Example:

For a lat-lon map at height 10 km (above MOLA areoid), between latitudes
-30 and 30 degrees (in steps of 5 degrees), and longitudes 0 to 180 degrees
(in steps of 20 degrees), enter 10 10 0 for z1, z2, dz; enter -30 30 5 for
lat1, lat2, dlat; and enter 0 180 20 for lon1, lon2, dlon.  All of these
input quantities are of type real, and can be entered to one or more
significant digits beyond the decimal.


                            PROGRAM FINDDATE

finddate.f90   - utility to find Earth date/time for desired Ls or Mars time

Program finddate.f90 allows calculation of the areocentric longitude of the Sun
(Ls) and Mars local true solar time (LTST) for a given Earth date and time.
It also computes the next occurrence (beyond the initial input date and
time) of the Earth date and time for which Ls and LTST are any desired
values.  Accuracy information and other documentary comments are given 
within the source code.  The program is interactive and prompts for all 
necessary inputs.


                            PROGRAM JULDAY

julday.f90    - utility to find the Julian day (e.g. for traveling waves)
                from year/month/day input

Traveling wave components require the Julian day for initialization of wave
phases.  Program julday.f90 calculates the Julian day from year, month, day
input. The program is interactive and prompts for all necessary inputs.


                            PROGRAM MARSRAD

marsrad.f90  - uses Mars-GRAM output to compute various solar (shortwave)
               and thermal (longwave) fluxes at the surface and the top of
               the atmosphere


Program marsrad.f90 uses Mars-GRAM output files containing height profile
information.  Profiles must start at the surface, should usually extend
upward to a height of 10 to 30 km, and may be at any desired height
resolution (limit 1000 points per profile).  Mars-GRAM output files used 
by marsrad.f90 are TPresHgt.txt, Density.txt, and MarsRad.txt.  See the file 
headers.txt that is provided in the Documentation Directory for a 
description of the parameters contained in these files.  

Program marsrad.f90 runs interactively, with the only user input required 
being the number (1or 2) of plot variables (Var_X and, optionally, Var_Y)
used in the Mars-GRAM output files. The marsrad.f90 program computes 
various solar (shortwave) and thermal (longwave) fluxes at the surface (sfc)
and the top of atmosphere (toa). Two marsrad output files are produced.  
Output file Radlist.txt contains an annotated set of radiation fluxes, 
equivalent (black-body) temperatures, and albedos.  Output file Radout.txt, 
suitable for input to a plot program, contains fluxes and other information
in one line for each set of output.  With an input "trajectory" file
(generated by program radtraj.f90 - see below), output file Radout.txt can
be used to plot solar and thermal radiation data as a map (lat-lon cross
section), or as lat-time or lon-time cross sections.  

Longwave radiative fluxes are computed by a broad-band (emissivity) method, 
patterned after Savijarvi, Contr. Atmos. Phys., 64, 103, 1991.  Dust optical 
depth tau is for the shortwave (solar) spectrum.  For longwave calculations,
infrared emissivity versus shortwave solar optical depth curves are used,
adapted from Haberle et al. (Icarus, 50, 322-367, 1982).  Infrared
emissivities for CO2 and water vapor are functions of pressure-scaled
optical path lengths (with emissivities from Staley and Jurica, J. Appl.
Meteorol., 9, 365, 1970). Shortwave fluxes are computed from total
dust optical depth (adjusted for small amount of clear-sky optical depth)
by a delta-Eddington method (Joseph et al., J. Atmos. Sci., 33, 2452,
1976).  Both longwave and shortwave effects of water vapor are included,
with relative humidity assumed constant at 20% (Savijarvi, 1991). Dust
optical properties assumed are 0.7 for asymmetry parameter, and 0.9
for single-scatter albedo.  Other reasonable values may be found in Table
1 of Murphy et al., J. Geophys. Res., 98(E2), 3197-3220, 1993. Values
of asymmetry parameter and single-scatter albedo (as well as assumed
relative humidity) can be changed in data statements near the beginning of
the marsrad program.  

Output parameters given in Radlist.txt output file
(in addition to plot variables, Var_X and, optionally, Var_Y) are:

  tau     = total vertical dust optical depth

  MarsAU  = Mars orbital radius (AU)

  mu0     = cosine of solar zenith angle 

  ice     = 0 for no ice on the surface, 1 for ice on the surface (affects
            surface albedo)
 
  Longwave (LW) fluxes F (W/m**2):

     Fdown(sfc)  = downwelling LW flux at surface

     Fup(sfc)    = upwelling LW flux at surface (related to Tsfc)

     Fup(toa)    = upwelling LW flux at top-of-atmosphere

     Femit(atmos)= LW flux emitted by atmosphere [Fup(toa) + net LW at sfc]
 
  Radiative (equivalent black-body) temperatures (K):

     Tsky(sfc)   = equivalent sky temperature [related to Fdown(sfc)]

     Tsfc        = ground surface temperature [related to Fup(sfc)]

     Teff(toa)   = effective black-body temperature at top-of-atmosphere
 
  Shortwave (SW) fluxes E (W/m**2):

     Edown(sfc)    = downwelling SW flux at surface

     Eup(sfc)      = upwelling SW flux at surface [albedo times Edown(sfc)]

     Eup(toa)      = upwelling SW flux at top-of-atmosphere

     Eabsorb(atmos)= net SW flux absorbed by atmosphere

     Edown(toa)    = solar flux at toa = mu0*(solar constant)/MarsAU**2
 
  Surface albedo   = surface albedo interpolated from file albedo1.txt

  Planetary albedo = ratio Eup(toa)/Edown(toa)   

  SW+LW Fluxes (W/m**2):

     Absorbed(sfc)  = SW+LW flux absorbed at the surface

     Emitted(toa)   = upwelling SW+LW flux at top-of-atmosphere

Controlled by parameter "heatrate" (set via user input), marsrad.f90 also 
outputs optical path lengths for water vapor (H2O), CO2, and dust.  H2O 
and CO2 optical path lengths are scaled by pressure to the 0.75 power.  
With heatrate set to 1, the program also outputs various fluxes (W/m**2) 
and heating rates (K/day) as a function of pressure level.  These 
optional outputs are:

  Pres    = pressure (mb)

  uH2O    = pressure-scaled H2O optical path (precipitable micrometers)

  uCO2    = pressure-scaled CO2 optical path (atmosphere-centimeters)

  udust   = dust optical depth from surface to given pressure level

  LWFup   = upwelling LW flux at pressure level

  LWFdn   = downwelling LW flux at pressure level

  LWFnet  = net (up - down) LW flux at pressure level

  LWdTdt  = LW heating rate at pressure level

  SWdTdt  = SW heating rate at pressure level

  TotdTdt = Total (LW+SW) heating rate at pressure level

Parameters given in Radout.txt output file (in addition to plot variables,
Var_X and, optionally, Var_Y) are:

  albsfc  = surface albedo (interpolated from file albedo1.txt)

  tau     = total vertical dust optical depth (for solar wavelengths)

  RadAU   = Mars orbital radius (AU)

  mu0     = cosine of solar zenith angle

  ice     = 0 for no ice on the surface, 1 for ice on the surface

  Tsfc    = ground surface temperature (K)

  Fusfc   = upwelling LW flux at surface (W/m**2)

  Tsky    = equivalent sky temperature (K)

  Fdsfc   = downwelling LW flux at surface (W/m**2)

  Teff    = effective black-body temperature at top-of atmosphere (K)

  Futoa   = upwelling LW flux at top-of-atmosphere (W/m**2)

  Edsfc   = downwelling SW flux at surface (W/m**2)

  Eusfc   = upwelling SW flux at surface (W/m**2)

  Edtoa   = solar flux at toa = mu0*(solar constant)/RadAU**2 (W/m**2)

  Eutoa   = upwelling SW flux at top-of-atmosphere (W/m**2)

  planalb = planetary albedo = ratio Eutoa/Edtoa
 
  thet    = Solar zenith angle (degrees)

  Tdif    = diffuse transmittance for diffuse irradiance

  Tdir    = diffuse transmittance for beam irradiance

  Tbeam   = beam transmittance


                            PROGRAM RADTRAJ

radtraj.f90   - special "trajectory" building program to compute vertical
                profiles at lat-lon, lat-time, or lon-time cross sections,
                for input to Mars-GRAM runs to produce output for input
                to marsrad radiation calculations

The radtraj.f90 program is similar in function and use to the BLDTRAJ.f90
"trajectory" building program, except that radtraj is especially designed
for use in conjunction with Mars-GRAM runs for which radiation
calculations are to be done by the marsrad.f90 program.  

Program radtraj produces a "trajectory" file consisting of sets of vertical 
profiles(constrained to start at the surface by automatically setting z1=-10).
Any heights that are below the surface are automatically ignored by
the marsrad.f90 program.  Any upper height z2 and height step dz may be used
for the height profiles.  However, it is not necessary to use z2 higher
than about 30 km.  The input time step (if other than zero) applies only as
the "trajectory" goes from one vertical profile to the next.
